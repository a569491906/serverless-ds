# 项目名称（Cloudflare Workers 脚本名）
name = "serverless-dns"

# 部署入口（npm run build 后会生成 ./dist/worker.js）
main = "./dist/worker.js"

# 启用 workers.dev 子域测试（先用这个验证能跑通）
workers_dev = true

# Cloudflare Workers 的兼容日期（建议用最新，保持与 runtime API 兼容）
compatibility_date = "2024-06-01"

# 构建配置（确保 Pages/Workers 部署时执行）
[build]
command = "npm run build"

# 文件规则，告诉 wrangler 要处理哪些文件
[[rules]]
type = "ESModule"
globs = ["**/*.js"]

# 环境变量（开发环境）
[vars]
LOG_LEVEL = "debug"
WORKER_ENV = "development"
CLOUD_PLATFORM = "cloudflare"

##################
# --- PROD ENV ---
##################
[env.prod]
# 生产环境的 Worker 名称
name = "serverless-dns-prod"

# 如果你没有自己的域名，可以先不写 routes，直接用 workers.dev
workers_dev = true
minify = true

[env.prod.vars]
LOG_LEVEL = "info"
WORKER_ENV = "production"
CLOUD_PLATFORM = "cloudflare"
